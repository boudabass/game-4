services:
  web:
    image: ghcr.io/boudabass/game-4:latest
    container_name: dyad-app-web
    ports:
      - "3000:3000"
    volumes:
      # STOCKAGE DONNÉES (db.json - Scores & Métadonnées)
      - /mnt/share1/server/apps/gamesenior/data:/app/data

      # STOCKAGE FICHIERS (Jeux p5.js statiques)
      - /mnt/share1/server/apps/gamesenior/games:/app/public/games

    environment:
      NODE_ENV: production
      # Force le passage de la clé de service depuis l'environnement hôte ou .env
      SUPABASE_SERVICE_ROLE_KEY: ${SUPABASE_SERVICE_ROLE_KEY}
    env_file:
      - ./.env

    restart: unless-stopped
