<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Elsass Farm</title>
    
    <link rel="stylesheet" href="style.css">
    
    <!-- 1. LIBRAIRIES -->
    <script src="https://cdn.jsdelivr.net/npm/p5@1.11.4/lib/p5.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.11.4/lib/addons/p5.sound.min.js"></script>
    <script src="https://p5play.org/v3/planck.min.js"></script>
    <script src="https://p5play.org/v3/p5play.js"></script>

    <!-- 2. SYSTEME -->
    <script>
        window.DyadGame = { id: 'elsass-farm-v1', version: 'v1' };
    </script>
    <script src="../../system/system.js"></script>

    <!-- 3. JEU -->
    <script src="config.js"></script>
    <script src="systems/UIManager.js"></script>
    <script src="main.js"></script>
    <script src="sketch.js"></script>

    <script>
        // Rendre les fonctions de bascule globales pour les appels onclick
        function toggleMenu() { UIManager.toggleMenu(); }
        function toggleMap() { UIManager.toggleMap(); }
        function toggleDebug() { UIManager.toggleDebug(); }
        function toggleFullscreen() { UIManager.toggleFullscreen(); }
        function toggleGrid() { UIManager.toggleGrid(); } // Nouvelle fonction
    </script>
</head>
<body>
    <!-- UI Layer -->
    <div id="ui-layer">
        <div class="hud-bar">
            <div class="hud-group">
                <span>‚ö° <span id="val-energy">100</span></span>
                <span>üí∞ <span id="val-gold">0</span></span>
            </div>
            <div class="hud-group">
                <span>üåÖ J<span id="val-day">1</span> <span id="val-time">6:00</span></span>
            </div>
            <div class="hud-group">
                <button class="hud-btn" onclick="toggleMap()">üó∫Ô∏è MAP</button>
                <button class="hud-btn" onclick="toggleMenu()">‚â° MENU</button>
            </div>
        </div>
        
        <!-- Menu Principal Modal -->
        <div id="menu-modal" class="modal-overlay" onclick="if(event.target.id === 'menu-modal') toggleMenu()">
            <div class="modal-content">
                <h3>PAUSE</h3>
                <div class="menu-list">
                    <button class="hud-btn" onclick="toggleFullscreen()">‚õ∂ Plein √âcran</button>
                    <button class="hud-btn" onclick="console.log('Save')">üíæ Sauvegarder</button>
                    <button class="hud-btn" onclick="toggleDebug()">üêõ Debug Info</button>
                    <button class="hud-btn" onclick="toggleMenu()">Reprendre</button>
                </div>
            </div>
        </div>

        <!-- Mini-Map Modal -->
        <div id="map-modal" class="modal-overlay" onclick="if(event.target.id === 'map-modal') toggleMap()">
            <div class="modal-content">
                <h3 style="color: white;">Carte de Elsas Farm</h3>
                <div id="minimap-grid" class="minimap-grid">
                    <!-- Tiles g√©n√©r√©es par JS -->
                </div>
            </div>
        </div>

        <!-- Debug Modal -->
        <div id="debug-modal" class="modal-overlay" onclick="if(event.target.id === 'debug-modal') toggleDebug()">
            <div class="modal-content" style="max-width: 400px; text-align: left;">
                <h3 style="color: white; text-align: center;">üêõ Debug Console</h3>
                <div class="menu-list" style="margin-top: 0;">
                    <button class="hud-btn" id="toggle-grid-btn" onclick="toggleGrid()">Toggle Grid (ON)</button>
                </div>
                <div id="debug-content" style="font-family: monospace; font-size: 14px; background: #000; padding: 10px; border-radius: 4px; overflow-y: auto;">
                    <!-- Contenu g√©n√©r√© par UIManager -->
                </div>
                <button class="hud-btn" onclick="toggleDebug()" style="margin-top: 15px; width: 100%;">Fermer</button>
            </div>
        </div>
    </div>
</body>
</html>